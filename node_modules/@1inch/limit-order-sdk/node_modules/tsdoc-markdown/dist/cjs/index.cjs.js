"use strict";var w=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var q=Object.prototype.hasOwnProperty;var U=(t,n)=>{for(var r in n)w(t,r,{get:n[r],enumerable:!0})},H=(t,n,r,m)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of V(n))!q.call(t,i)&&i!==r&&w(t,i,{get:()=>n[i],enumerable:!(m=z(n,i))||m.enumerable});return t};var Q=t=>H(w({},"__esModule",{value:!0}),t);var en={};U(en,{buildDocumentation:()=>M,documentationToMarkdown:()=>x,generateDocumentation:()=>tn});module.exports=Q(en);var g=require("fs");var b=require("path/posix"),e=require("typescript"),T=({checker:t,symbol:n,doc_type:r})=>({name:n.getName(),documentation:(0,e.displayPartsToString)(n.getDocumentationComment(t)),type:t.typeToString(t.getTypeOfSymbolAtLocation(n,n.valueDeclaration)),jsDocs:n.getJsDocTags(),...r&&{doc_type:r}}),G=({checker:t,symbol:n,doc_type:r})=>{let{members:m}=n.valueDeclaration,i=m.map(s=>{var o;let f=(0,e.displayPartsToString)(s.symbol.getDocumentationComment(t)),l=(o=s.initializer)==null?void 0:o.getText();return{name:s.name.getText(),...l!==void 0&&{type:l},...f!==void 0&&f!==""&&{documentation:f}}});return{name:n.getName(),documentation:(0,e.displayPartsToString)(n.getDocumentationComment(t)),properties:i,jsDocs:n.getJsDocTags(),doc_type:r??"enum"}},W=({checker:t,symbol:n})=>{let r=T({checker:t,symbol:n,doc_type:"class"}),m=t.getTypeOfSymbolAtLocation(n,n.valueDeclaration);return r.constructors=m.getConstructSignatures().map(i=>Y({checker:t,signature:i})).filter(({documentation:i})=>i!==void 0&&i!==""),r},X=t=>{let n=(0,e.getCombinedModifierFlags)(t);return((0,e.isMethodDeclaration)(t)||(0,e.isPropertyDeclaration)(t))&&t.name.kind===e.SyntaxKind.PrivateIdentifier?!1:(n&e.ModifierFlags.Export)!==0||(n&e.ModifierFlags.Public)!==0||(0,e.isClassDeclaration)(t.parent)&&[e.ModifierFlags.None,e.ModifierFlags.Static].includes(n)},Y=({checker:t,signature:n})=>{var m;let r={parameters:n.parameters.map(i=>T({checker:t,symbol:i})),returnType:t.typeToString(n.getReturnType()),documentation:(0,e.displayPartsToString)(n.getDocumentationComment(t))};return n.declaration&&"modifiers"in n.declaration?{...r,visibility:((m=n.declaration.modifiers)==null?void 0:m[0].kind)===e.SyntaxKind.PrivateKeyword?"private":"public"}:{...r,visibility:"public"}},F=t=>(0,e.isArrowFunction)(t)?t:(0,e.forEachChild)(t,F),Z=t=>[e.SyntaxKind.TypePredicate,e.SyntaxKind.TypeReference,e.SyntaxKind.FunctionType,e.SyntaxKind.ConstructorType,e.SyntaxKind.TypeQuery,e.SyntaxKind.TypeLiteral,e.SyntaxKind.ArrayType,e.SyntaxKind.TupleType,e.SyntaxKind.OptionalType,e.SyntaxKind.RestType,e.SyntaxKind.UnionType,e.SyntaxKind.IntersectionType,e.SyntaxKind.ConditionalType,e.SyntaxKind.InferType,e.SyntaxKind.ParenthesizedType,e.SyntaxKind.ThisType,e.SyntaxKind.TypeOperator,e.SyntaxKind.IndexedAccessType,e.SyntaxKind.MappedType,e.SyntaxKind.LiteralType,e.SyntaxKind.NamedTupleMember,e.SyntaxKind.TemplateLiteralType,e.SyntaxKind.ImportType].includes(t),A=t=>{if(t.parent)return(0,e.isVariableDeclaration)(t.parent)&&(0,e.isIdentifier)(t.parent.name)?t.parent.name.text:A(t.parent)},v=t=>{let n=t.parent;return n?n.kind===e.SyntaxKind.SourceFile||n.kind===e.SyntaxKind.ClassDeclaration?!0:n.kind===e.SyntaxKind.FunctionDeclaration||n.kind===e.SyntaxKind.FunctionExpression||n.kind===e.SyntaxKind.ArrowFunction||n.kind===e.SyntaxKind.PropertyAssignment||n.kind===e.SyntaxKind.ObjectLiteralExpression?!1:v(n):!1},O=({checker:t,node:n,types:r,...m})=>{if(!X(n))return[];let i=[],s=({details:l,node:o})=>{i.push({...l,...P({node:o,...m})})},f=({symbol:l,doc_type:o,node:a})=>{if(!l)return;let u=T({checker:t,symbol:l,doc_type:o});s({node:a,details:u})};if((0,e.isClassDeclaration)(n)&&n.name){let l=t.getSymbolAtLocation(n.name);if(l){let o={...W({checker:t,symbol:l}),methods:[],properties:[],...P({node:n,...m})};(0,e.forEachChild)(n,u=>{var c,d;let p=O({node:u,checker:t,types:r,...m}),y=({fileName:D,...h})=>h;(c=o.methods)==null||c.push(...p.filter(({doc_type:D})=>D==="method"||D==="function").map(y)),(d=o.properties)==null||d.push(...p.filter(({doc_type:D})=>D==="property").map(y))}),i.push(o)}}else if((0,e.isModuleDeclaration)(n))(0,e.forEachChild)(n,o=>{let a=O({node:o,checker:t,types:r,...m});i.push(...a)});else if((0,e.isMethodDeclaration)(n)){let l=t.getSymbolAtLocation(n.name);f({symbol:l,doc_type:"method",node:n})}else if((0,e.isFunctionDeclaration)(n)){let l=t.getSymbolAtLocation(n.name??n);f({symbol:l,doc_type:"function",node:n})}else{let l=F(n);if(l!==void 0){let o=t.getSymbolAtLocation(l.parent.name);if(o!==void 0){let a=v(l)?void 0:A(l),u=T({checker:t,symbol:o,doc_type:"function"});s({node:n,details:{...u,name:a!==void 0?`${a}.${u.name}`:u.name}})}}else if((0,e.isPropertyDeclaration)(n)){let o=t.getSymbolAtLocation(n.name);f({symbol:o,doc_type:"property",node:n})}else if((0,e.isVariableStatement)(n)){let{declarationList:{declarations:o,flags:a}}=n;if((a&e.NodeFlags.Const)!==0){let p=o[0].symbol;f({symbol:p,doc_type:"const",node:n})}}else if(r&&(0,e.isInterfaceDeclaration)(n)){let o=t.getSymbolAtLocation(n.name);if(o){let a=n.members.filter(p=>(0,e.isPropertySignature)(p)&&p.name!==void 0&&(0,e.isIdentifier)(p.name)).map(p=>t.getSymbolAtLocation(p.name)).filter(p=>p!==void 0).map(p=>T({checker:t,symbol:p})),u={...T({checker:t,doc_type:"interface",symbol:o}),properties:a,...P({node:n,...m})};i.push(u)}}else if(r&&(0,e.isTypeAliasDeclaration)(n)){let o=t.getSymbolAtLocation(n.name);if(o){let a=n.getChildren().find(({kind:p})=>Z(p)),u={...T({checker:t,doc_type:"type",symbol:o}),...P({node:n,...m}),type:a==null?void 0:a.getText().replace(/^"|"$/g,"")};i.push(u)}}else if((0,e.isEnumDeclaration)(n)){let o=t.getSymbolAtLocation(n.name),a=G({checker:t,symbol:o});s({node:n,details:a})}}return i},L={target:e.ScriptTarget.ES2020,module:e.ModuleKind.CommonJS,strictNullChecks:!0},P=({repo:t,node:n,sourceFile:r})=>{let m=r.fileName;if(t===void 0)return{fileName:m};let{url:i,branch:s}=t,{line:f}=r.getLineAndCharacterOfPosition(n.getStart()),l=(0,b.relative)(process.cwd(),r.fileName),o=`${i.replace(/\/+$/,"")}/tree/${s??"main"}/${l.replace(/^\.\.\//,"")}#L${f+1}`;return{fileName:m,url:o}},M=({inputFiles:t,options:n})=>{let{compilerOptions:r,explore:m,repo:i,types:s}=n??{explore:!1,compilerOptions:L,types:!1},f=m??!1,l=s??!1,o=(0,e.createProgram)(t,r??L),a=o.getSourceFiles(),u=t.map(d=>(0,b.resolve)(d)),p=a.filter(({isDeclarationFile:d,fileName:D})=>!d&&(f||u.includes((0,b.resolve)(D)))),y=o.getTypeChecker(),c=[];for(let d of p)(0,e.forEachChild)(d,D=>{let h=O({checker:y,node:D,sourceFile:d,repo:i,types:l});c.push(...h)});return c};var j=t=>(t??[]).map(({name:n,documentation:r})=>({name:n,documentation:r??""})),R=t=>t!==void 0&&t!==""?`: ${t}`:"",J=t=>t.map(({name:n,documentation:r})=>`* \`${n}\`${R(r)}`),nn=({entry:t,headingLevel:n,emoji:r})=>{let{name:m,url:i,documentation:s,methods:f,properties:l,constructors:o}=t,a=[`${n}${S({emoji:r,key:"classes"})} ${m}
`];s!==void 0&&s!==""&&a.push(`${s}
`),i!==void 0&&a.push(B({emoji:r,url:i}));let u=(o??[]).filter(({visibility:p})=>p==="public");return u!=null&&u.length&&(a.push(`${n}# Constructors
`),a.push(...u.map(({parameters:p,documentation:y,visibility:c})=>{let d=[`\`${c}\`${R(y)}
`];return p!=null&&p.length&&(d.push(`Parameters:
`),d.push(...J(j(p)))),d.join(`
`)})),a.push(`
`)),((f==null?void 0:f.length)??0)>0&&(a.push(`${n}# Methods
`),a.push(`${E({entries:f??[],emoji:r})}
`),a.push(`${k({entries:f??[],headingLevel:`${n}#`,docType:"Method",emoji:r})}`)),((l==null?void 0:l.length)??0)>0&&(a.push(`${n}# Properties
`),a.push(`${E({entries:l??[],emoji:r})}
`),a.push(`${k({entries:l??[],headingLevel:`${n}#`,docType:"Property",emoji:r})}`)),a.join(`
`)},_=({entry:t,headingLevel:n,emoji:r})=>{let{name:m,documentation:i}=t,s=[`${n}# ${r==null?"":":gear: "}${m}
`];return i!==void 0&&s.push(`${i}
`),s.push("| Property | Type | Description |"),s.push("| ---------- | ---------- | ---------- |"),(t.properties??[]).forEach(({name:f,type:l,documentation:o,jsDocs:a})=>{let u=(a??[]).map(({name:p,text:y})=>`${p}${y!==void 0?`: ${y.map(({text:c})=>c).join("")}`:""}`);s.push(`| \`${f}\` | \`${C(l??"")}\` | ${o!==void 0&&o!==""?`${C(o).replace(/\r?\n|\r/g,"")}`:""}${u.length>0?` ${C(u.join(""))}`:""} |`)}),s.push(`
`),s.join(`
`)},B=({url:t,emoji:n})=>`[${S({emoji:n,key:"link"}).trim()}${n!=null?" ":""}Source](${t})
`,C=t=>t.split(`
`).map(n=>n.trim()).join(" ").replace(/ \| /g," or ").replace(/ & /g," and "),k=({entries:t,headingLevel:n,docType:r,emoji:m})=>{let i=o=>{let p=o.filter(({name:c})=>c==="param").map(({text:c})=>c).reduce((c,d)=>d===void 0?c:[...c,d],[]),y=c=>{var h,N;if(c.find(({kind:$,text:K})=>$==="parameterName"&&K!=="")===void 0)return;let d=((h=c.find(({kind:$})=>$==="parameterName"))==null?void 0:h.text)??"",D=((N=c.find(({kind:$})=>$==="text"))==null?void 0:N.text)??"";return{name:d,documentation:D}};return p.map(y).filter(c=>c!==void 0)},s=o=>o.filter(({name:p})=>p==="example").map(({text:p})=>p).filter(Boolean).flat(1).map(({text:p})=>p).filter(Boolean),f=t.map(({name:o,type:a,documentation:u,parameters:p,jsDocs:y,url:c})=>({name:o,type:a??"",documentation:u??"",params:[...j(p),...i(y??[])],examples:[...s(y??[])],url:c})),l=({name:o,documentation:a,type:u,params:p,examples:y,url:c})=>{let d=[`${n}# ${m==null?"":":gear: "}${o}
`];return a.length&&d.push(`${a}
`),d.push(`| ${u==="Type"?"Type alias":r} | Type |`),d.push("| ---------- | ---------- |"),d.push(`| \`${o}\` | ${u!==void 0&&u!==""?`\`${C(u)}\``:""} |
`),p.length&&(d.push(`Parameters:
`),d.push(...J(p)),d.push(`
`)),y.length&&(d.push(`Examples:
`),d.push(...y),d.push(`
`)),c!==void 0&&d.push(B({emoji:m,url:c})),d.join(`
`)};return f.map(l).join(`
`)},E=({entries:t,emoji:n})=>t.map(({name:r})=>`- [${r}](#${n==null?"":`${n.entry}-`}${r.toLowerCase().replace(/ /g,"-")})`).join(`
`),S=({emoji:t,key:n})=>t==null?"":` :${t[n]}:`,I={classes:"factory",functions:"toolbox",constants:"wrench",enum:"nut_and_bolt",entry:"gear",link:"link",interfaces:"tropical_drink",types:"cocktail"},x=({entries:t,options:n})=>{let{headingLevel:r,emoji:m}=n??{headingLevel:"##",emoji:I},i=r??"##",s=m===null?void 0:m??I,f=t.filter(({doc_type:c})=>c==="function"),l=t.filter(({doc_type:c})=>c==="class"),o=t.filter(({doc_type:c})=>c==="const"),a=t.filter(({doc_type:c})=>c==="enum"),u=t.filter(({doc_type:c})=>c==="type"),p=t.filter(({doc_type:c})=>c==="interface"),y=[];return f.length&&(y.push(`${i}${S({emoji:s,key:"functions"})} Functions
`),y.push(`${E({entries:f,emoji:s})}
`),y.push(`${k({entries:f,headingLevel:i,emoji:s,docType:"Function"})}
`)),o.length&&(y.push(`${i}${S({emoji:s,key:"constants"})} Constants
`),y.push(`${E({entries:o,emoji:s})}
`),y.push(`${k({entries:o,headingLevel:i,emoji:s,docType:"Constant"})}
`)),y.push(l.map(c=>nn({entry:c,headingLevel:i,emoji:s})).join(`
`)),a.length&&(y.push(`${i}${S({emoji:s,key:"enum"})} Enum
`),y.push(`${E({entries:a,emoji:s})}
`),y.push(a.map(c=>_({entry:c,headingLevel:i,emoji:s})).join(`
`))),p.length&&(y.push(`${i}${S({emoji:s,key:"interfaces"})} Interfaces
`),y.push(`${E({entries:p,emoji:s})}
`),y.push(p.map(c=>_({entry:c,headingLevel:i,emoji:s})).join(`
`))),u.length&&(y.push(`${i}${S({emoji:s,key:"types"})} Types
`),y.push(`${E({entries:u,emoji:s})}
`),y.push(`${k({entries:u,headingLevel:i,emoji:s,docType:"Type"})}
`)),y.join(`
`)};var tn=({inputFiles:t,outputFile:n,markdownOptions:r,buildOptions:m})=>{let i=M({inputFiles:t,options:m}),s=x({entries:i,options:r});if((0,g.existsSync)(n)){let f=(0,g.readFileSync)(n,"utf-8"),l=/(<!-- TSDOC_START -->)[\s\S]*?(<!-- TSDOC_END -->)$/gm;if(!f.match(l)){(0,g.writeFileSync)(n,s,"utf-8");return}let o=`<!-- TSDOC_START -->

${s}
<!-- TSDOC_END -->`;(0,g.writeFileSync)(n,f.replace(l,o),"utf-8");return}(0,g.writeFileSync)(n,s,"utf-8")};0&&(module.exports={buildDocumentation,documentationToMarkdown,generateDocumentation});
//# sourceMappingURL=index.cjs.js.map
